<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>CMS WM Monitoring</title>
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alumni+Sans+SC:ital,wght@0,100..900;1,100..900&family=Audiowide&family=Playpen+Sans:wght@100..800&display=swap"
      rel="stylesheet"
    />
    <!-- And here is how we can include bootstrap into our website -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT"
      crossorigin="anonymous"
    />
    <script src="https://unpkg.com/axios/dist/axios.js"></script>
    <script type="module" src="../app.js"></script>
    <script type="module" src="../table-functions.js"></script>
  </head>
  <body>
    <header>
      <div class="container-fluid bg-primary text-white text-left">
        <div class="row align-items-center" style="border: thick solid #deddca">
          <div class="col-2">
            <img
              alt="CMS Experiment logo"
              src="../images/cms_logo.png"
              class="img-fluid img-xs"
            />
          </div>
          <div class="col-10">
            <h2 class="alumni-sans-sc-h1">WM Workflow</h2>
          </div>
        </div>
      </div>
    </header>

    <div class="container-fluid bg-secondary text-white text-left">
      <div class="row align-items-left" style="border: thick solid #deddca">
        <div class="row">
          <div class="col">
            <p class="alumni-sans-sc-h2">
              This page will contain a form to be submitted to the backend,
              retrieve data from the database and show the data. Type in any
              field to filter the table below.
            </p>
          </div>
        </div>
        <!-- the action needs to be fixed
        <form action="#" method="get">-->
        <form method="GET">
          <div class="row">
            <div class="col">
              Campaign:
              <input
                type="text"
                class="form-control filter-input"
                name="campaign"
                data-column="campaign"
                size="25"
                maxlength="100"
                placeholder="Enter campaign"
              />
            </div>
            <div class="col">
              Type:
              <input
                type="text"
                class="form-control filter-input"
                name="type"
                data-column="type"
                size="25"
                maxlength="30"
                placeholder="Enter type"
              />
            </div>
            <div class="col">
              Status:
              <input
                type="text"
                class="form-control filter-input"
                name="status"
                data-column="status"
                size="25"
                maxlength="30"
                placeholder="Enter status"
              />
            </div>
            <div class="col">
              Workflow:
              <input
                type="text"
                class="form-control filter-input"
                name="workflow"
                data-column="workflow"
                size="25"
                maxlength="150"
                placeholder="Enter workflow"
              />
            </div>
            <div class="col">
              Agent:
              <input
                type="text"
                class="form-control filter-input"
                name="agent"
                data-column="agent"
                size="25"
                maxlength="50"
                placeholder="Enter agent"
              />
            </div>
            <div class="col">
              Team name:
              <input
                type="text"
                class="form-control filter-input"
                name="teamname"
                data-column="teamname"
                size="25"
                maxlength="50"
                placeholder="Enter team"
              />
            </div>
            <div class="col">
              Site:
              <input
                type="text"
                class="form-control filter-input"
                name="site"
                data-column="site"
                size="25"
                maxlength="50"
                placeholder="Enter site"
              />
            </div>
            <div class="col">
              Input Dataset:
              <input
                type="text"
                class="form-control filter-input"
                name="inputdataset"
                data-column="inputdataset"
                size="25"
                maxlength="250"
                placeholder="Enter input data"
              />
            </div>
            <div class="col">
              Output Dataset:
              <input
                type="text"
                class="form-control filter-input"
                name="outputdataset"
                data-column="outputdataset"
                size="25"
                maxlength="250"
                placeholder="Enter output data"
              />
            </div>
            <!-- Only adding some extra space at the bottom of the row-->
            <div class="row">
              <div class="col-12">
                <button
                  id="sortBtn"
                  type="button"
                  class="btn btn-primary mt-3 mb-2 me-2"
                >
                  <i class="bi bi-funnel"></i> Sort
                </button>
                <button
                  id="resetBtn"
                  type="button"
                  class="btn btn-warning mt-3 mb-2 me-2"
                >
                  <i class="bi bi-arrow-counterclockwise"></i> Reset
                </button>
                <button
                  id="downloadCsvBtn"
                  type="button"
                  class="btn btn-success mt-3 mb-2"
                >
                  <i class="bi bi-download"></i> Download as CSV
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- This table will eventually be populated with dynamic data-->
    <div class="container-fluid">
      <div class="table-responsive">
        <table
          id="workflowTable"
          class="table table-light table-striped table-hover table-bordered table-sm"
        >
          <thead class="table-light">
            <tr>
              <th scope="col">#</th>
              <th scope="col">Workflow</th>
              <th scope="col">Status</th>
              <th scope="col">Type</th>
              <th scope="col">Priority</th>
              <th scope="col">Created</th>
              <th scope="col">Pending</th>
              <th scope="col">Running</th>
              <th scope="col">Success</th>
              <th scope="col">Failure</th>
            </tr>
          </thead>
          <tbody id="app" />
        </table>
      </div>
    </div>

    <!-- And here is how we can include bootstrap into our website -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>

    <script>
      // Initialize table functionality when DOM is loaded
      document.addEventListener("DOMContentLoaded", function () {
        // Import and initialize table functions
        import("/js/components/table_functions.js").then((module) => {
          module.initializeTable();

          // Make functions available globally for app.js
          window.initializeTableFeatures = module.initializeTableFeatures;
          window.filterTable = module.filterTable;
          window.updateRowNumbers = module.updateRowNumbers;
        });
      });
    </script>
  </body>
</html>
